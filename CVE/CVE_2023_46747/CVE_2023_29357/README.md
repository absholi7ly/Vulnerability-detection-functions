# Microsoft SharePoint: CVE-2023-29357 
### Microsoft SharePoint Server elevation of privilege vulnerability

This script exploits a vulnerability (CVE-2023-29357) in Microsoft SharePoint Server that allows remote attackers to escalate privileges on affected installations of Microsoft SharePoint Server. While this script is focused on elevation of privilege, attackers with malicious intent may combine this vulnerability with a Remote Code Execution (RCE) vulnerability (CVE-2023â€“24955) to compromise the integrity, availability, and confidentiality of the target system.
The exploit script facilitates the impersonation of authenticated users, allowing attackers to execute arbitrary code, modify settings, and create new users in the context of the SharePoint application pool and SharePoint server farm account, potentially causing a denial of service (DoS). The script extracts details of elevated privileged administrative users and can work in both single and group exploitation modes. However, to maintain an ethical stance,

To ensure the program runs successfully, you must have some required libraries and tools. You can download the scripts from requirements
Below are the requirements:
```
requests==2.26.0
rich==10.9.0
alive-progress==1.6.3
leakpy==0.1.0
```
Make sure these libraries are installed using the following command in your Python environment:
```
pip install -r requirements.txt
```
This will install the specific versions of the selected libraries.

## Run the program:
Specify the options required when running the program, such as base link (-u), import list of links (-l), number of threads (-t), output file (-o) and others.

You can also use additional options like --leakpy to import links using Leakix.
Start running the program using the command on the command line:
```
python CVE-2023-29357.py -u http://example.com -t 10 -o output.txt -v
```
```
where:
-u: basic link.
-t: number of threads.
-o: Name of the output file.
-v: To print the detailed output of the program run.
```
After running the program, you can examine the output file you selected to see the results. You can use a text editor or other viewing tool.
If you specify detailed output (-v, verbose), you will see the results of the program as it runs.

This code is used to test the CVE-2023-29357 vulnerability in the SharePoint system. I will explain the code in general:

### Imported libraries:
Libraries like json and requests are imported to handle data and requests.
The argparse library is used to control data entered from the command line.
base64 and time are used to handle JWT Tokens.
LeakixScraper from leakpy.scraper library used to retrieve a list of SharePoint sites.

### Input verification:
argparse is used to verify data entered from the command line such as URL, output file, and more.

### SharePoint class:
You organize many functions to work with SharePoint.
The client_id and other SharePoint information are specified.
It provides many functions such as user-related operations, modification of settings, and access to sensitive data.

### Main function:
It reads the parameters from the command line and determines whether Leakix should be used to retrieve the list of sites.
You create a set of tasks to scan multiple SharePoint sites simultaneously.
ThreadPoolExecutor is used to improve concurrent execution performance.

### function check_url:
It scans the individual site and performs specific exploits as needed.
SharePoint class functions are called to perform operations such as creating a user account or modifying settings.

### Other functions:
It offers many sub-functions for specific purposes such as generating JWT Token, specifying aud field, and hacking administrator accounts.

### main implementation if __name__ == "__main__":
Verifies that the program is run directly (and not imported).
It executes the main function to start the program.

## How to use the function in another program:
You can import functions from this program into your new program using:
```
from my_script import SharePoint, check_url, fetch_from_leakix, main
```
You can use these functions in your program based on the need. For example, you can use check_url to scan a single site, or fetch_from_leakix to retrieve a list of sites, and so on.

Thanks @Chocapikk
