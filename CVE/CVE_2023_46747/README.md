# CVE-2023-46747
The CVE-2023-46747 vulnerability works by interacting with a processor vulnerability in Drupal. Attackers can easily do this by stringing a path to an HTTP request. Through this chain, the application is redirected to another website, through which subscribers can log in to the site without knowing their username or password.
The vulnerability is based on the fact that the authenticated handler in Drupal does not properly validate the URL that is used to log in. Attackers can use this vulnerability to create a URL containing a special script to redirect the application to another website.

## Requirements to run. You need the following:

### Install required libraries:
requests library
spacy library

You can install the required libraries using the pip package manager.
```
pip install requests
pip install spacy
```

### Spacy library configuration:
You need to configure the spacy library using the English model. You can do this using the following line:
```
import space
nlp = space.load("en_core_web_sm")
```
## Function usage:
Once you have installed the required libraries and configured the spacy library, you can use the function in the following way.

### Step 1: Create a request to the site.

The function sends an HTTP request to the site using the specified URL.
```
request = requests.get(url + "/?q=user/login&destination=admin/config/people/accounts")
```
### Step 2: Check the site's responsiveness.
The function first checks the HTTP response for the expected data. If you find this data, the site is vulnerable. If you don't find this data, the function proceeds to the next step.
```
if re.search(expected_data, request.headers["X-Drupal-Cache"]):
  # The response contains the expected data, meaning the site is vulnerable.
  return True, request.url, "user/login&destination=admin/config/people/accounts"
```
### Step 3: Check the statistical patterns.
The function uses the Statistical Analysis technique to check the HTTP response for statistical patterns that indicate a vulnerability. If you find these patterns, it also means that the site is vulnerable to the vulnerability.
```
response_text = request.text
tokens = nlp(response_text)
for token in tokens:
  if token.text in expected_patterns:
    # The response contains the expected statistical patterns, meaning the site is vulnerable.
    return True, request.url, "user/login&destination=admin/config/people/accounts"
```
### Step 4: Result
If the function finds any vulnerability, it will return True. If it finds no vulnerability, it will return False.
```
return False, None, None
```
### How to use the function 

To use the function in another program, you first need to import it. You can do this using the following line:
```
from detect_cve_2023_46747 import detect_cve_2023_46747
```
Once you import the function, you can use it in the following way:
```
url = "https://example.com/drupal"
results = detect_cve_2023_46747(url)

if results[0]:
  print("The site is vulnerable to CVE-2023-46747.")
  print("The URL specified in the path is:", results[1])
  print("The custom path used to check for the vulnerability is:", results[2])
else:
  print("The site is not vulnerable to CVE-2023-46747.")
```
